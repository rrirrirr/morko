// Nicekeyboards nice!nano v2
// Params
//  orientation: default is down
//    if down, power led will face the pcb
//    if up, power led will face away from pcb

module.exports = {
  nets: {
    BATP: "BAT+",
    BATM: "BAT-",
    BATP: "BAT+",
    GND: "GND",
    RST: "RST",
    VCC: "VCC",
    P031: "P031",
    P029: "P029",
    P002: "P002",
    P115: "P115",
    P113: "P113",
    P111: "P111",
    P010: "P010",
    P009: "P009",
    P006: "P006",
    P008: "P008",
    P017: "P017",
    P020: "P020",
    P022: "P022",
    P024: "P024",
    P100: "P100",
    P011: "P011",
    P104: "P104",
    P101: "P101",
    P102: "P102",
    P107: "P107",
    P106: "P106",
    DATA: "DATA",

    MIRROR_BATP: "MIRROR_BAT+",
    MIRROR_BATM: "MIRROR_BAT-",
    MIRROR_BATP: "MIRROR_BAT+",
    MIRROR_GND: "MIRROR_GND",
    MIRROR_RST: "MIRROR_RST",
    MIRROR_VCC: "MIRROR_VCC",
    MIRROR_P031: "MIRROR_P031",
    MIRROR_P029: "MIRROR_P029",
    MIRROR_P002: "MIRROR_P002",
    MIRROR_P115: "MIRROR_P115",
    MIRROR_P113: "MIRROR_P113",
    MIRROR_P111: "MIRROR_P111",
    MIRROR_P010: "MIRROR_P010",
    MIRROR_P009: "MIRROR_P009",
    MIRROR_P006: "MIRROR_P006",
    MIRROR_P008: "MIRROR_P008",
    MIRROR_P017: "MIRROR_P017",
    MIRROR_P020: "MIRROR_P020",
    MIRROR_P022: "MIRROR_P022",
    MIRROR_P024: "MIRROR_P024",
    MIRROR_P100: "MIRROR_P100",
    MIRROR_P011: "MIRROR_P011",
    MIRROR_P104: "MIRROR_P104",
    P101: "MIRROR_P101",
    P102: "MIRROR_P102",
    P107: "MIRROR_P107",
    MIRROR_P106: "MIRROR_P106",
    MIRROR_DATA: "MIRROR_DATA",
  },
  params: {
    class: "MCU",
    orientation: "down",
    mirror: false,
  },
  body: (p) => {
    const standard = `
      (module nice!nano (layer F.Cu) (tedit 5B307E4C)
      ${p.at /* parametric position */}

      ${"" /* footprint reference */}
      (fp_text reference "${p.ref}" (at 0 0) (layer B.SilkS) ${
      p.ref_hide
    } (effects (font (size 1.27 1.27) (thickness 0.15))))
      (fp_text value "" (at 0 0) (layer B.SilkS) hide (effects (font (size 1.27 1.27) (thickness 0.15))))
    
      ${"" /* illustration of the (possible) USB port overhang */}
      (fp_line (start -19.304 -3.81) (end -14.224 -3.81) (layer Dwgs.User) (width 0.15))
      (fp_line (start -19.304 3.81) (end -19.304 -3.81) (layer Dwgs.User) (width 0.15))
      (fp_line (start -14.224 3.81) (end -19.304 3.81) (layer Dwgs.User) (width 0.15))
      (fp_line (start -14.224 -3.81) (end -14.224 3.81) (layer Dwgs.User) (width 0.15))
      `;
    function pins(def_neg, def_pos) {
      if (p.net?.BATP) {
        console.log("yes");
      } else {
        return "";
      }
      return !p.param?.mirror
        ? `
        ${"" /* and now the actual pins */}
        (pad 1 thru_hole rect (at -13.97 ${def_pos}7.62 ${
            p.rot
          }) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.BATP.str
          })
        (pad 2 thru_hole circle (at -11.43 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.GND.str
          })
        (pad 3 thru_hole circle (at -8.89 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.RST.str
          })
        (pad 4 thru_hole circle (at -6.35 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.VCC.str
          })
        (pad 5 thru_hole circle (at -3.81 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P031.str
          })
        (pad 6 thru_hole circle (at -1.27 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P029.str
          })
        (pad 7 thru_hole circle (at 1.27 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P002.str
          })
        (pad 8 thru_hole circle (at 3.81 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P115.str
          })
        (pad 9 thru_hole circle (at 6.35 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P113.str
          })
        (pad 10 thru_hole circle (at 8.89 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P111.str
          })
        (pad 11 thru_hole circle (at 11.43 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P010.str
          })
        (pad 12 thru_hole circle (at 13.97 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P009.str
          })
        
        (pad 13 thru_hole circle (at -13.97 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P006.str
          })
        (pad 14 thru_hole circle (at -11.43 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P008.str
          })
        (pad 15 thru_hole circle (at -8.89 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.GND.str
          })
        (pad 16 thru_hole circle (at -6.35 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.GND.str
          })
        (pad 17 thru_hole circle (at -3.81 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P017.str
          })
        (pad 18 thru_hole circle (at -1.27 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P020.str
          })
        (pad 19 thru_hole circle (at 1.27 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P022.str
          })
        (pad 20 thru_hole circle (at 3.81 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P024.str
          })
        (pad 21 thru_hole circle (at 6.35 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P100.str
          })
        (pad 22 thru_hole circle (at 8.89 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P011.str
          })
        (pad 23 thru_hole circle (at 11.43 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P104.str
          })
        (pad 24 thru_hole circle (at 13.97 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.P106.str
          })   
        `
        : `
        ${"" /* and now the actual pins */}
        (pad 1 thru_hole rect (at -13.97 ${def_pos}7.62 ${
            p.rot
          }) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_BATP.str
          })
        (pad 2 thru_hole circle (at -11.43 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_GND.str
          })
        (pad 3 thru_hole circle (at -8.89 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_RST.str
          })
        (pad 4 thru_hole circle (at -6.35 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_VCC.str
          })
        (pad 5 thru_hole circle (at -3.81 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P031.str
          })
        (pad 6 thru_hole circle (at -1.27 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P029.str
          })
        (pad 7 thru_hole circle (at 1.27 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P002.str
          })
        (pad 8 thru_hole circle (at 3.81 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P115.str
          })
        (pad 9 thru_hole circle (at 6.35 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P113.str
          })
        (pad 10 thru_hole circle (at 8.89 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P111.str
          })
        (pad 11 thru_hole circle (at 11.43 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P010.str
          })
        (pad 12 thru_hole circle (at 13.97 ${def_pos}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P009.str
          })
        
        (pad 13 thru_hole circle (at -13.97 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P006.str
          })
        (pad 14 thru_hole circle (at -11.43 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P008.str
          })
        (pad 15 thru_hole circle (at -8.89 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_GND.str
          })
        (pad 16 thru_hole circle (at -6.35 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_GND.str
          })
        (pad 17 thru_hole circle (at -3.81 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P017.str
          })
        (pad 18 thru_hole circle (at -1.27 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P020.str
          })
        (pad 19 thru_hole circle (at 1.27 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P022.str
          })
        (pad 20 thru_hole circle (at 3.81 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P024.str
          })
        (pad 21 thru_hole circle (at 6.35 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P100.str
          })
        (pad 22 thru_hole circle (at 8.89 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P011.str
          })
        (pad 23 thru_hole circle (at 11.43 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P104.str
          })
        (pad 24 thru_hole circle (at 13.97 ${def_neg}7.62 0) (size 1.7526 1.7526) (drill 1.0922) (layers *.Cu *.SilkS *.Mask) ${
            p.net.MIRROR_P106.str
          })   
        `;
    }
    if (p.param?.orientation == "down") {
      return `
        ${standard}
        ${pins("-", "")}
        )
        `;
    } else {
      return `
        ${standard}
        ${pins("", "-")}
        )
        `;
    }
  },
};
